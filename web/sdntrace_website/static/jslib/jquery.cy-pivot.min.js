(function(B){var C={init:function(W){var Y=B.extend({},B.fn.cypivot.defaults,W);var V=this;if(Y.resizable){B(window).resize(function(){if(Y.resizableWidth){d(V)}if(Y.resizableHeight){U(V)}})}var X=this.each(function(){var ad=B(this);ad.data("cypivot",{target:ad,options:Y});if(Y.cookiePrefix&&Y.storeDimConfig){var ac=B.cookie(Y.cookiePrefix+"horizontalDims");var aa=B.cookie(Y.cookiePrefix+"verticalDims");var ab=B.cookie(Y.cookiePrefix+"filterDims");if(ac&&m(Y.dimensions,ac)&&m(Y.dimensions,aa)){Y.horizontalDimensions=ac.split(";")}if(aa&&m(Y.dimensions,ac)&&m(Y.dimensions,aa)){Y.verticalDimensions=aa.split(";")}if(ab&&m(Y.dimensions,ab)&&m(Y.dimensions,ab)){Y.filterDimensions=ab.split(";")}}var Z='<div class="'+Y.div11Class+'">'+Y.configLabel+"</div>";if(!Y.configuration){Z=""}ad.html('<table class="'+Y.tableClass+'">  <tr class="'+Y.topRowClass+'">    <td class="'+Y.cell11Class+'">'+Z+'    </td>    <td class="'+Y.cell12Class+'">      <div class="'+Y.div12Class+'">      </div>    </td>  </tr>  <tr class="'+Y.bottomRowClass+'">    <td class="'+Y.cell21Class+'">      <div class="'+Y.div21Class+'">      </div>    </td>    <td class="'+Y.cell22Class+'">      <div class="'+Y.div22Class+'-super">      <div class="'+Y.div22Class+'">        <table class="'+Y.pivotDataTableClass+'">      </div>      </div>    </td>  </tr></table><div id="'+Y.pivotConfigDialogId+'" class="'+Y.configDialogClass+'"></div>');ad.find("."+Y.div22Class).on("scroll",function(){M(ad,Y)});ad.find("."+Y.cell22Class).resize(function(){M(ad,Y)});ad.find("."+Y.div11Class).on("click",function(){h(ad,Y)});H(ad,Y);ad.find("#"+Y.pivotConfigDialogId).dialog({modal:false,title:"Pivot Table Configuration",position:["right","50px"],beforeClose:function(){var ae=ad.find("."+Y.div11Class);ae.removeClass(Y.configWindowActivatedClass)}});jQuery("#"+Y.pivotConfigDialogId).dialog("close");M(ad,Y);o(ad,[],[Y.verticalDimensions[0],Y.horizontalDimensions[0]],0,0,Y);w(ad,Y)});if(Y.resizable){if(Y.resizableWidth){d(V)}if(Y.resizableHeight){U(V)}}return X},options:function(W,V){var Y=B(this);var X=Y.data("cypivot");return X.options},reload:function(W,V){return this.each(function(){var ac=B(this),ab=ac.data("cypivot");if(W){ab.options.data=W}if(V){var X=ac.find("."+ab.options.div22Class+" ."+ab.options.pivotDataTableClass);var Z=X[0];var ad;for(var Y=0;Y<Z.rows.length;Y++){var af=Z.rows[Y];for(var aa=0;aa<af.cells.length;aa++){var ae=af.cells[aa];if(r(ae.colContext,V.colContext)&&r(ae.rowContext,V.rowContext)){ae.isCalculated=false}}}A(ac,ab.options)}else{A(ac,ab.options,true)}})},reconfig:function(V){var W=B.extend({},B.fn.cypivot.defaults,V);var X=B(this);f(X,W)}};B.fn.cypivot=function(V){if(C[V]){return C[V].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof V==="object"||!V){return C.init.apply(this,arguments)}else{B.error("Method "+V+" does not exist on jQuery.tooltip")}}};function o(W,aa,X,ac,V,Z){var ab=function(af){var ah=Z.verticalDimensions[0];var ae=y(af,X,ah,"");console.log("curData",af);console.log("values",ae);$pivotDataTable=W.find("."+Z.div22Class+" ."+Z.pivotDataTableClass);var ad=W.find("."+Z.div21Class);var ae=J(ad,Z,Z.horizontalDimensions,[],af);K($pivotDataTable[0],Z,0,ae.length);var ag=W.find("."+Z.div12Class);ae=J(ag,Z,Z.verticalDimensions,[],af);R($pivotDataTable[0],Z,0,ae.length,af);n(W,Z)};var Y=Z.dataProvider(Z,aa,X,ab);if(Y){ab(Y)}}function H(aj,W){var X=aj.find("."+W.configDialogClass);var ag={};var ai='<li class="'+W.dimensionListTitleClass+'" vdims="true">'+W.verticalDimensionListTitle+"</li>";for(var ab=0;ab<W.verticalDimensions.length;ab++){var ah=W.verticalDimensions[ab];ag[ah]=true;var ac=W.dimensions[ah];ai=ai+'<li dim="'+ah+'">'+ac.label+"</li>"}if(!W.configuration||!W.configuration.verticalDimensions){ai=""}var ad='<li class="'+W.dimensionListTitleClass+'" hdims="true">'+W.horizontalDimensionListTitle+"</li>";for(var ab=0;ab<W.horizontalDimensions.length;ab++){var ah=W.horizontalDimensions[ab];ag[ah]=true;var ac=W.dimensions[ah];ad=ad+'<li dim="'+ah+'">'+ac.label+"</li>"}if(!W.configuration||!W.configuration.horizontalDimensions){var ad=""}var V='<li class="'+W.dimensionListTitleClass+'" fdims="true">'+W.filterDimensionListTitle+"</li>";for(var ab=0;ab<W.filterDimensions.length;ab++){var ah=W.filterDimensions[ab];ag[ah]=true;var ac=W.dimensions[ah];var Y=y(W,[],ah,"");var Z="<ul>";for(var af=0;af<Y.length;af++){var ae=Y[af];Z=Z+"<li><input type='checkbox' value='"+ae.id+"'/>"+ae.label+"</li>"}Z=Z+"</ul>";V=V+'<li dim="'+ah+'">'+ac.label+Z+"</li>"}if(!W.configuration||!W.configuration.filterDimensions){V=""}var aa="";for(var ah in W.dimensions){if(ag[ah]!=true){var ac=W.dimensions[ah];aa=aa+'<li dim="'+ah+'">'+ac.label+"</li>"}}X.append('<ul class="'+W.firstDimensionListClass+'" style="padding-bottom:0px; margin-bottom:0px;"><li class="'+W.dimensionListTitleClass+'">'+W.dimensionListTitle+'</li></ul><ul class="'+W.dimensionListClass+'" style="padding-top:0px; margin-top:0px;">'+aa+ad+ai+V+"</ul>");X.find("ul."+W.dimensionListClass).sortable({cancel:"."+W.dimensionListTitleClass,update:function(){var an=[],ap=[],ao=[],al=[];X.find("."+W.dimensionListClass+" li").each(function(){var ar=jQuery(this).attr("dim");if(ar){al[al.length]=ar}if(jQuery(this).attr("vdims")=="true"){al=an}if(jQuery(this).attr("hdims")=="true"){al=ap}if(jQuery(this).attr("fdims")=="true"){al=ao}});if(W.configuration&&W.configuration.verticalDimensions==true){W.verticalDimensions=an}if(W.configuration&&W.configuration.horizontalDimensions==true){W.horizontalDimensions=ap}if(W.configuration&&W.configuration.filterDimensions==true){W.filterDimensions=ao}if(W.cookiePrefix&&W.storeDimConfig){var aq=W.horizontalDimensions.join(";");var ak=W.verticalDimensions.join(";");var am=W.filterDimensions.join(";");B.cookie(W.cookiePrefix+"horizontalDims",aq,{expires:15});B.cookie(W.cookiePrefix+"verticalDims",ak,{expires:15});B.cookie(W.cookiePrefix+"filterDims",am,{expires:15})}f(aj,W)}})}function h(W,X){if(X.configuration){var V=W.find("."+X.div11Class);V.toggleClass(X.configWindowActivatedClass);if(V.hasClass(X.configWindowActivatedClass)){jQuery("#"+X.pivotConfigDialogId).dialog("open")}else{var Y=jQuery("#"+X.pivotConfigDialogId);Y.dialog("close")}}}function b(V,X){var Z;if(V.hasClass(X.levelClassPrefix+"0")){Z=V.parent()}else{Z=V.parents("."+X.levelClassPrefix+"0").parent()}var W=0;var Y=false;Z.find("."+X.dimLabelClass).each(function(){if(!Y){var aa=V[0];if(this==aa){Y=true;return false}else{var ab=B(this);if(ab.parent().children("."+X.dimCellClass).size()==0){W++}}}});return W}function P(V,X){var Z;if(V.hasClass(X.levelClassPrefix+"0")){Z=V.parent()}else{Z=V.parents("."+X.levelClassPrefix+"0").parent()}var W=0;var Y=false;Z.find("."+X.dimLabelClass).each(function(){if(!Y){var aa=V[0];if(this==aa){Y=true;return false}else{var ab=B(this);W++}}});return W}function c(V,W){var X=[];V.find("."+W.div21Class+" ."+W.dimCellClass).each(function(){X[X.length]=this.pivotContext});return X}function L(V,W){var X=[];V.find("."+W.div12Class+" ."+W.dimCellClass).not("."+W.expandedDimCellClass).each(function(){X[X.length]=this.pivotContext});return X}function p(V,Y){var Z=V.parent();var X=0;var W=V[0];Z.find("."+Y.dimLabelClass).each(function(){var aa=B(this);if(aa.parent().children("."+Y.dimCellClass).size()==0){X++}});return X}function I(V,Y){var Z=V.parent();var X=0;var W=V[0];X=Z.find("."+Y.dimLabelClass).not(W).size();return X}function f(X,Y){var V=X.find("."+Y.div21Class);V.html("");var Z=X.find("."+Y.div12Class);Z.html("");var W=X.find("."+Y.div22Class);W.html('<table class="'+Y.pivotDataTableClass+'">');o(X,[],[Y.verticalDimensions[0],Y.horizontalDimensions[0]],0,0,Y)}function F(V,X,W){$pivotDataTable=V.find("."+X.div22Class+" ."+X.pivotDataTableClass);$pivotDataTable.html("");i(V,$pivotDataTable,X,[],W);A(V,X);n(V,X)}function w(V,W){V.on("click","."+W.div12Class+" ."+W.dimLabelClass,function(aj){var ae=V.find("."+W.div22Class+" ."+W.pivotDataTableClass);var ac=new Date();var ab,an;var aa=B(this);var ai=false;if(aa.hasClass(W.expandedDimLabelClass)){var al=p(aa,W);if(al>0){var ao=b(aa,W);var am=ae[0];var Y=N(am,ao,al-1);k(am,ao,al-1,function(){aa.parent().find("."+W.dimCellClass).remove();aa.width(Y+"px");var aq=-1;for(var ar=0;ar<am.rows.length;ar++){var at=am.rows[ar];cell=at.cells[ao];if(aq<0){aq=jQuery(cell).width()}}aa.removeClass(W.expandedDimLabelClass).addClass(W.collapsedDimLabelClass);aa.parent().removeClass(W.expandedDimCellClass).addClass(W.collapsedDimCellClass);A(V,W);n(V,W)})}an=W.onCollapse}else{if(aa.hasClass(W.collapsedDimLabelClass)){var ah=this.parentElement.pivotContext;var af=b(aa,W);var ag=aa.parent();var ad=function(ar){J(ag,W,W.verticalDimensions,null,ar);var aq=p(aa,W);if(aq>0){aa.addClass(W.expandedDimLabelClass).removeClass(W.collapsedDimLabelClass);aa.parent().addClass(W.expandedDimCellClass).removeClass(W.collapsedDimCellClass);if(aq>0){R(ae[0],W,af,aq-1,ar)}ai=true}n(V,W);ab=W.onExpand};var X=a(ah,W.verticalDimensions);var ak=q(V,W);var Z=G(V,W);if(ah.length==Z){ak.push(W.verticalDimensions[ah.length])}var ap=W.dataProvider(W,X,ak,ad);if(ap){ad(ap)}}}if(ai){A(V,W);if(W.resizable){if(W.resizableWidth){d(V)}if(W.resizableHeight){U(V)}}if(an){an(this)}if(ab){ab(this)}n(V,W)}return false});V.on("click","."+W.div21Class+" ."+W.dimLabelClass,function(aj){var ae=new Date();var ac,an;if(aj.isPropagationStopped()){return}var ab=B(this);var ag=ab.parent();var ai=false;if(ab.hasClass(W.expandedDimLabelClass)){var al=I(ab,W);var X=P(ab,W);var am=$pivotDataTable[0];if(al>0){x(am,X+1,al);ag.find("."+W.dimCellClass).remove();ab.removeClass(W.expandedDimLabelClass);ab.addClass(W.collapsedDimLabelClass);ag.removeClass(W.expandedDimCellClass);ag.addClass(W.collapsedDimCellClass);ai=true}an=W.onCollapse}else{if(ab.hasClass(W.collapsedDimLabelClass)){var ah=this.parentElement.pivotContext;var Y=P(ab,W);var af=function(aq){J(ag,W,W.horizontalDimensions,null,aq);ab.addClass(W.expandedDimLabelClass).removeClass(W.collapsedDimLabelClass);ag.addClass(W.expandedDimCellClass).removeClass(W.collapsedDimCellClass);var ap=I(ab,W);if(ap>0){K($pivotDataTable[0],W,Y+1,ap,aq);ai=true}n(V,W);ac=W.onExpand};var Z=a(ah,W.horizontalDimensions);var ak=q(V,W);var aa=g(V,W);if(ah.length==aa){ak.push(W.horizontalDimensions[ah.length])}var ao=W.dataProvider(W,Z,ak,af);if(ao){af(ao)}ac=W.onExpand}}if(ai){if(W.resizable){if(W.resizableWidth){d(V)}if(W.resizableHeight){U(V)}}A(V,W);if(an){an(this)}if(ac){ac(this)}n(V,W)}var ad=new Date();return false})}function a(Y,X){var W={};for(var V=0;V<Y.length;V++){W[X[V]]=Y[V]}return W}function q(V,X){var W=[];e(V,X,X.div21Class,X.horizontalDimensions,W);e(V,X,X.div12Class,X.verticalDimensions,W);return W}function e(X,ab,W,aa,Z){var V=0;X.find("."+W+" ."+ab.dimCellClass).each(function(){if(V<this.pivotContext.length){V=this.pivotContext.length}});for(var Y=0;Y<V;Y++){Z.push(aa[Y])}}function G(W,X){var V=0;W.find("."+X.div12Class+" ."+X.dimCellClass).each(function(){if(V<this.pivotContext.length){V=this.pivotContext.length}});return V}function g(W,X){var V=0;W.find("."+X.div21Class+" ."+X.dimCellClass).each(function(){if(V<this.pivotContext.length){V=this.pivotContext.length}});return V}function N(Y,aa,Z){var W=0;var ab=Y.rows[0];for(var V=0;V<Z;V++){cell=ab.cells[aa+V];var X=jQuery(cell).width();W+=X}return W}function A(ac,ah,W){var al=c(ac,ah);var Z=L(ac,ah);var ak=ac.find("."+ah.div22Class+" ."+ah.pivotDataTableClass);var ae=ak[0];var aj;for(var X=0;X<ae.rows.length;X++){var aa=ae.rows[X];var Y=al[X];aj=null;for(var ag=0;ag<aa.cells.length;ag++){var af=Z[ag];var V=aa.cells[ag];V.colContext=af;V.rowContext=Y;if(V.isCalculated!=true||W==true){if(aj==null){aj=ah.map(Y,[],ah.data)}var ai=ah.map(Y,af,aj["default"]);var ab=ah.reduce(ai);var ad="";if(ah.dataCellRenderer){ad=ah.dataCellRenderer(ab,af,Y,ah)}else{if(B("#cellTemplate").size()>0){var am=B("#cellTemplate").html();ad=_.template(am,{items:ab,rowContext:Y,colContext:af,options:ah})}}jQuery(V).html('<div class="'+ah.divDataCellClass+'">'+ad+"</div>");V.isCalculated=true}}}}function j(W){var X="[";for(var V=0;V<W.length;V++){var Y=W[V];if(V>0){X=X+", "}X=X+Y.label}X=X+"]";return X}function R(ak,ag,al,am,W){var ad=B(ak);var aj=c(ad.parents(".cypivot"),ag);var aa=L(ad.parents(".cypivot"),ag);for(var Y=0;Y<ak.rows.length;Y++){var ab=ak.rows[Y];var Z=aj[Y];for(var ai=0;ai<am;ai++){var af=aa[al+ai];var X=ab.insertCell(al+ai);X.className=ag.dataCellClass;var V=document.createElement("div");X.appendChild(V);V.className=ag.divDataCellClass;var ah=ag.map(Z,af,W);var ac=ag.reduce(ah);var ae="";if(ag.dataCellRenderer){ae=ag.dataCellRenderer(ac,af,Z,ag)}B(V).html(ae)}}}function K(al,ah,aj,ad,W){var ac=B(al);var ak=c(ac.parents(".cypivot"),ah);var Z=L(ac.parents(".cypivot"),ah);var V=al.rows.length>0?al.rows[0]:null;for(var X=0;X<ad;X++){var aa=al.insertRow(aj+X);var Y=ak[aj+X];var ae=[];if(V){for(var ag=0;ag<V.cells.length;ag++){var af=Z[ag];var ai=ah.map(Y,af,W);var ab=ah.reduce(ai);var am="";if(ah.dataCellRenderer){am=ah.dataCellRenderer(ab,af,Y,ah)}ae.push('<td class="'+ah.dataCellClass+'"><div class="'+ah.divDataCellClass+'">'+am+"</div></td>")}}jQuery(aa).html(ae.join(""))}}function k(Z,ac,aa,Y){for(var X=0;X<Z.rows.length;X++){var ab=Z.rows[X];for(var W=0;W<aa;W++){var V=ab.cells[ac+W];ab.deleteCell(ac)}}if(Y){Y()}if(aa==0&&Y){}}function x(X,Y,V){for(var W=0;W<V;W++){X.deleteRow(Y)}}function O(X,aa,ab,W){var V="."+aa.div21Class;for(var Y=0;Y<ab.length;Y++){V=V+" ."+aa.levelClassPrefix+Y+"."+aa.pivotIdClassPrefix+ab[Y].id}V=V+" ."+aa.dimLabelClass;var Z=X.find(V).first();W.resize(function(){Z.css({height:(W.height()-2)+"px"})});Z.css({height:(W.height()-2)+"px"})}function n(V,W){if(W.syncDimensionCellSizes==true){E(V,W);S(V,W)}}function S(V,Y){var Z=V.find("."+Y.div22Class+" ."+Y.pivotDataTableClass);var X=Z[0];var aa=X.rows[0];var W=0;if(aa){V.find("."+Y.dimLabelClass).each(function(){var ag=jQuery(this);if(ag.hasClass(Y.expandedDimLabelClass)){ag.parent().css({width:"auto"})}else{var ac=aa.cells[W];var ai=jQuery(ac);ag.css("width","auto");var af=(ai.outerWidth())+"px";if(W<aa.cells.length-1){var ae=aa.cells[W+1];var ah=jQuery(ae);var ab=ai.position();var ad=ah.position();af=ad.left-ab.left}ag.parent().css({width:af});W++}})}}function E(V,Y){var Z=V.find("."+Y.div22Class+" ."+Y.pivotDataTableClass);var X=Z[0];var aa=X.rows[0];var W=0;V.find("."+Y.div21Class+" ."+Y.dimLabelClass).each(function(){var ae=X.rows[W];var ad=jQuery(ae);var ac=jQuery(this);var ab=(ad.innerHeight()-2)+"px";ac.css({height:ab});W++})}function i(ae,ab,V,X,ac){var Z=V.horizontalDimensions[X.length];var Y=s(X);var aa=V.dimensions[Z];if(aa){var W=function(ag){for(var ai=0;ai<ag.length;ai++){var aj=ag[ai];Y[X.length]=aj;var ah=ab[0];var ak=ah.insertRow(-1);var af=jQuery(ak);af.addClass(V.dataRowClass+" "+V.levelClassPrefix+X.length+" "+V.pivotIdClassPrefix+aj.id+' " pivotId = "'+aj.id);D(ae,ab,af,V,Y,[]);if(V.isExpanded(Y)&&Y.length<V.horizontalDimensions.length){i(ae,ab,V,Y,ac);if(aa.showTotal&&false){ab.append('<tr class="'+V.dimCellClass+" "+V.dataTotalCellClass+" "+V.levelClassPrefix+X.length+" "+V.pivotIdClassPrefix+aj.id+'" pivotId = "'+aj.id+'"><div class="'+V.dimLabelClass+'">Total '+aj.label+"</div></tr>")}}}ae.css({height:"10px"});ae.css({height:"auto"});n(ae,V)};var ad;if(aa.values){ad=aa.values(X,W)}else{ad=y(ac,X,Z,aa.sortFieldName)}if(ad!=undefined){W(ad)}}}function y(ad,W,Y,V){var ab=[];for(var Z=0;Z<ad.length;Z++){var ag=ad[Z];if(v(ag,W)){ab.push(ag)}}var aa=[];var ac={};for(var Z=0;Z<ab.length;Z++){var ag=ab[Z];var af=v(ag,W);var ae=ag[Y];var X=typeof(ae)=="object"?ae.id:ae;if(ae&&ae!=Number.POSITIVE_INFINITY&&ac[X]!=true){ac[X]=true;aa.push(ae)}}if(V!=undefined){aa=aa.sort(function(ai,ah){if(ai[V]<ah[V]){return -1}if(ai[V]>ah[V]){return 1}return 0})}return aa}function v(ac,X){for(var W in X){var aa=X[W];var ab=aa.dimName;var Z=aa.id;var V=ac[ab];if(V!=undefined){var Y;if(typeof V==="number"){Y=V}else{if(typeof V==="string"){Y=V}else{Y=V.id}}if(Y!=null&&Y!=undefined){if(Z!=Y&&Y!=Number.POSITIVE_INFINITY){return false}}}}return true}function t(ac,X){for(var W in X){var aa=X[W];var ab=aa.dimName;var Z=aa.id;var V=ac[ab];if(V!=undefined){var Y=V.id;if(Y!=null&&Y!=undefined){if(Z!=Y&&Y!=-1){return false}}}}return true}function D(ae,ah,ak,ai,Y,ag,V){var ad=ai.verticalDimensions[ag.length];var Z=s(ag);var al=ai.dimensions[ad];var am=Y[Y.length-1];var ab=ak[0];if(al){var X=al.values?al.values(ag):y(V,ag,ad,al.sortFieldName);for(var ac=0;ac<X.length;ac++){var aj=X[ac];Z[ag.length]=aj;if(ai.isExpanded(Z)&&Z.length<ai.verticalDimensions.length){D(ae,ah,ak,ai,Y,Z);if(al.showTotal){var W=ab.insertCell(ab.cells.length);var aa=jQuery(W);W.className=ai.dataCellClass+" "+ai.dataTotalCellClass+" "+ai.levelClassPrefix+ag.length+" "+ai.pivotIdClassPrefix+aj.id;aa.attr("pivotId",aj.id);aa.html('<div class="'+ai.divDataCellClass+'">Total '+aj.label+"</div>");W.rowContext=Y;W.colContext=ag}}else{var W=ab.insertCell(ab.cells.length);var aa=jQuery(W);aa.addClass(ai.dataCellClass+" "+ai.levelClassPrefix+ag.length+" "+ai.pivotIdClassPrefix+aj.id);aa.attr("pivotId",aj.id);var af=typeof(am)=="object"?am.label:am;aa.html('<div class="'+ai.divDataCellClass+'">'+af+" - "+af+"</div>")}}}}function J(am,ah,ac,Z,V){var ao;if(!Z){Z=am[0].pivotContext}else{am[0].pivotContext=s(Z)}var ag=ac[Z.length];var aa=s(Z);var ak=ah.dimensions[ag];var Y=am.find("."+ah.dimTotalCellClass);if(ak){var X=ak.values?ak.values(Z):y(V,Z,ag,ak.sortFieldName);ao=X;if(X.length>0){am.children("."+ah.dimLabelClass).css({width:""})}for(var ae=0;ae<X.length;ae++){var aj=X[ae];var af=typeof(aj)=="object"?aj.id:aj;var ad=typeof(aj)=="object"?aj.label:aj;aj=typeof(aj)=="object"?aj:{id:aj,label:aj};aj.dimName=ag;aa[Z.length]=aj;var al=document.createElement("div");if(Y.size()>0){al=am[0].insertBefore(al,Y[0])}else{al=am[0].appendChild(al)}var W=jQuery(al);W.addClass(ah.dimCellClass+" "+ah.dimCellClass+"-"+ag+" "+ah.levelClassPrefix+Z.length+" "+ah.pivotIdClassPrefix+af);W.attr({pivotId:af,dimName:ag,title:ak.label+" : "+unescape(ad)});var an=ah.dimensionCellRenderer?ah.dimensionCellRenderer(ah,aa,false):"<span title='"+ak.label+": "+ad+"'><i class='"+ah.dimCellIconClass+"'></i>"+ad+"</span>";W.append('<div class="'+ah.dimLabelClass+" "+ah.dimLabelClass+"-"+ag+" "+(ak.className?ak.className+" ":"")+(aa.length<ac.length?ah.expandableDimLabelClass:"")+'">'+an+"</div>");var ai=W.children("."+ah.dimLabelClass);al.pivotContext=s(aa);if(ah.isExpanded(aa)&&aa.length<ac.length){ai.addClass(ah.expandedDimLabelClass);ai.parent().addClass(ah.expandedDimCellClass);var ab=am.children("."+ah.pivotIdClassPrefix+af);J(ab,ah,ac,aa,V)}else{if(aa.length<ac.length){ai.addClass(ah.collapsedDimLabelClass);ai.parent().addClass(ah.collapsedDimCellClass)}}}if(Y.size()==0&&Z.length>0&&ac==ah.verticalDimensions){var al=document.createElement("div");al=am[0].appendChild(al);var W=jQuery(al);W.addClass(ah.dimCellClass);W.addClass(ah.dimTotalCellClass);W.addClass(ah.levelClassPrefix+Z.length);W.attr("dimName",ag);al.pivotContext=s(Z);var an=ah.dimensionCellRenderer?ah.dimensionCellRenderer(ah,aa,true):"";W.append('<div class="'+ah.dimLabelClass+'">Total</div>')}}return ao}function M(X,Y){var Z=u();var W=X.find("."+Y.div22Class);if(!Y.autoSize){X.find("."+Y.div12Class).css({width:(W.width()-Z)+"px"})}var V=W.height()-Z;if(!Y.autoSize){X.find("."+Y.div21Class).css({height:V+"px","margin-bottom":Z+"px"})}X.find("."+Y.div12Class).scrollLeft(W.scrollLeft());X.find("."+Y.div21Class).scrollTop(W.scrollTop())}B.fn.cypivot.defaults={syncDimensionCellSizes:true,resizable:true,resizableWidth:true,resizableHeight:true,autoSize:false,tableClass:"cypivot",topRowClass:"top-row",bottomRowClass:"bottom-row",cell11Class:"cell11",cell12Class:"cell12",cell21Class:"cell21",cell22Class:"cell22",div11Class:"div11",div12Class:"div12",div21Class:"div21",div22Class:"div22",pivotDataTableClass:"pivot-data-table",dimLabelClass:"dim-label",dimCellIconClass:"dim-cell-icon",dimCellClass:"dim-cell",expandableDimLabelClass:"expandable-dim-label",expandedDimLabelClass:"expanded-dim-label",collapsedDimLabelClass:"collapsed-dim-label",expandedDimCellClass:"expanded-dim-cell",collapsedDimCellClass:"collapsed-dim-cell",dimTotalCellClass:"dim-total-cell",dataTotalCellClass:"data-total-cell",levelClassPrefix:"level-",dataRowClass:"data-row",dataCellClass:"data-cell",divDataCellClass:"div-data-cell",configDialogClass:"config-dialog",dimensionListTitle:"Dimensions",horizontalDimensionListTitle:"Rows",verticalDimensionListTitle:"Columns",filterDimensionListTitle:"Filters",configWindowActivatedClass:"config-window-activated",dimensionListClass:"dimension-list",firstDimensionListClass:"first-dimension-list",dimensionListTitleClass:"dimension-list-title",verticalDimensionListClass:"vertical-dimension-list",horizontalDimensionListClass:"horizontal-dimension-list",filterDimensionListClass:"filter-dimension-list",pivotIdClassPrefix:"pivot-id-",pivotConfigDialogId:"pivot-config-dialog",isExpanded:function(V){return V.length==0},configuration:{horizontalDimensions:true,verticalDimensions:true,filterDimensions:false},configLabel:"Config",cookiePrefix:"cy-pivot-",storeDimConfig:true,dataCellRenderer:function(V,ab,Z,Y){var aa="";for(var W=0;W<Y.valueDataFields.length;W++){var X=Y.valueDataFields[W];aa=aa+"<span class='value-"+X+"'>"+V["default"].sum[X]+"</span> "}return aa},dataProvider:function(X,W,V){return X.data},dimensionCellRenderer:null,dimensions:{dim1:{label:"Colors",values:function(V){return[{id:1,label:"Red"},{id:2,label:"Blue"},{id:3,label:"Green"}]},showTotal:true},dim2:{label:"Cities",values:function(V){return[{id:1,label:"Saint-Petersburg"},{id:2,label:"Moscow"},{id:3,label:"London"},{id:4,label:"Paris"}]},showTotal:true},dim3:{label:"Shapes",values:function(V){return[{id:1,label:"Round"},{id:2,label:"Square"},{id:3,label:"Star"},{id:4,label:"Ellipse"}]},showTotal:true},dim4:{label:"Planets",values:function(V){return[{id:1,label:"Earth"},{id:2,label:"Moon"},{id:3,label:"Mars"},{id:4,label:"Neptune"}]},showTotal:true},dim5:{label:"Geo",values:function(V){return[{id:1,label:"Asia"},{id:2,label:"Africa"},{id:3,label:"Europe"},{id:4,label:"America"}]},showTotal:true},dim6:{label:"Lessons",values:function(V){return[{id:1,label:"Phisics"},{id:2,label:"Chemistry"},{id:3,label:"Math"},{id:4,label:"Geography"}]},showTotal:true}},horizontalDimensions:["dim1","dim3","dim5"],verticalDimensions:["dim2"],filterDimensions:[],data:[{dim1:"Red",dim2:"Saint-Petersburg",dim3:"Round",dim4:"Earth",dim5:"Asia",dim6:"Phisics",value:1},{dim1:"Red",dim2:"Saint-Petersburg",dim3:"Round",dim4:"Earth",dim5:"Asia",dim6:"Chemistry",value:1},{dim1:"Blue",dim2:"Saint-Petersburg",dim3:"Round",dim4:"Earth",dim5:"Asia",dim6:"Chemistry",value:1},{dim1:"Green",dim2:"Moscow",dim3:"Round",dim4:"Earth",dim5:"Asia",dim6:"Chemistry",value:1}],map:function(W,V,Y){var aa=[];var ac=[];var X=[];for(var Z=0;Z<W.length;Z++){var ab=W[Z];X.push(ab)}for(var Z=0;Z<V.length;Z++){var ab=V[Z];X.push(ab)}for(var Z=0;Z<Y.length;Z++){var ad=Y[Z];if(Q(ad,X)){aa.push(ad)}if(z(this,ad,X)){ac[ac.length]=ad}}return{"default":aa,stricted:ac}},valueDataFields:["value"],reduce:function(ai){var aj={};for(itemsKey in ai){var ad=ai[itemsKey];var ac={};var ab={};var ae={},Y={};for(var Z=0;Z<this.valueDataFields.length;Z++){var af=this.valueDataFields[Z];var V=0;var W=Number.NEGATIVE_INFINITY;var ag=Number.POSITIVE_INFINITY;for(var aa=0;aa<ad.length;aa++){var ah=ad[aa];var X=ah[af];V+=X;if(ag>X){ag=X}if(W<X){W=X}}ac[af]=V;ae[af]=W;Y[af]=ag}aj[itemsKey]={};aj[itemsKey]["sum"]=ac;aj[itemsKey]["count"]=ad.length;aj[itemsKey]["avg"]=ac/ad.length;aj[itemsKey]["max"]=ae;aj[itemsKey]["min"]=Y}return aj},reduces:[{valueDataFields:["value"],map:"default",reduce:function(aa,ae){var Z={};var Y={};for(var X=0;X<this.valueDataFields.length;X++){var ac=this.valueDataFields[X];Z[ac]=0;Y[ac]=aa.length}var ab={},W={};for(var X=0;X<aa.length;X++){var ad=aa[X];for(var V=0;V<this.valueDataFields.length;V++){var ac=this.valueDataFields[V];Z[ac]+=ad[ac];if(W[ac]){if(W[ac]>ad[ac]){W[ac]=ad[ac]}}else{W[ac]=ad[ac]}if(ab[ac]){if(ab[ac]>ad[ac]){ab[ac]=ad[ac]}}else{ab[ac]=ad[ac]}}}if(ae){ae.sum=Z;ae.count=aa.length;ae.avg=Z/aa.length;ae.max=ab;ae.min=W}return Z}}]};function s(X){if(!X||"object"!==typeof X){return X}var Y="function"===typeof X.pop?[]:{};var W,V;for(W in X){if(X.hasOwnProperty(W)){V=X[W];if(V&&"object"===typeof V){Y[W]=s(V)}else{Y[W]=V}}}return Y}function l(Z,W){for(var V in W){var Y=W[V];var X=Z[Y.dimName];if(Y.id!=X){return false}}return true}function Q(Z,W){for(var V=0;V<W.length;V++){var Y=W[V];var X=Z[Y.dimName];if(typeof(X)=="object"&&X!=null){X=X.id}if(Y.id!=X){return false}}return true}function z(V,ab,W){var ac={};for(var ad in W){var Z=W[ad];var aa=Z.dimName;var Y=Z.id;var X=ab[aa];if(Y!=X){return false}ac[aa]=Y}for(var ad in V.dimensions){if(ac[ad]==undefined){if(ab[ad]!=undefined){return false}}}return true}function u(){var X=document.createElement("p");X.style.width="100%";X.style.height="200px";var Y=document.createElement("div");Y.style.position="absolute";Y.style.top="0px";Y.style.left="0px";Y.style.visibility="hidden";Y.style.width="200px";Y.style.height="150px";Y.style.overflow="hidden";Y.appendChild(X);document.body.appendChild(Y);var W=X.offsetWidth;Y.style.overflow="scroll";var V=X.offsetWidth;if(W==V){V=Y.clientWidth}document.body.removeChild(Y);return(W-V)}function d(V){var W=V.find(".div22").offset().left;V.find(".div22").css({width:(window.innerWidth-W)+"px"});V.find(".div12").css({width:(window.innerWidth-W)+"px"})}function U(V){var W=V.find(".div22").offset().top;V.find(".div22").css({height:(window.innerHeight-W)+"px"});V.find(".div21").css({height:(window.innerHeight-W)+"px"})}function T(V){return typeof V==="number"&&isFinite(V)}function r(X,W){if(W.length<X.length){return false}for(var V=0;V<X.length;V++){if(X[V].id!=W[V].id){return false}}return true}function m(Y,Z){Z=Z.split(";");for(var V=0;V<Z.length;V++){var X=Z[V];var W=Y[X];if(W==undefined){return false}}return true}})(jQuery);